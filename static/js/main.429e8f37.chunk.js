(window["webpackJsonpconverse-player"]=window["webpackJsonpconverse-player"]||[]).push([[0],[,,function(e,t,a){e.exports={main:"Timeline_main__2ME79",username:"Timeline_username__PRBkx",messageWindow:"Timeline_messageWindow__AmH5J",inputBox:"Timeline_inputBox__2wi8d",caption:"Timeline_caption__2aekk",captionInner:"Timeline_captionInner__1r14r",loader:"Timeline_loader__2oDsm","up-down":"Timeline_up-down__cKBJS"}},,function(e,t,a){e.exports={header:"Header_header__1MOL-",details:"Header_details__3Q1mh",avatar:"Header_avatar__Hhfmo",title:"Header_title__3_fub",lastSeen:"Header_lastSeen__SMPbV",status:"Header_status__2qA-9"}},function(e){e.exports=JSON.parse('{"story":{"theme":"blue","users":[{"id":1,"name":"Brandon Johnson","avatar":"http://normalimage.cdn.ucbt.net/person_5157.png"},{"id":2,"name":"Boaty McBoatface","avatar":"https://static01.nyt.com/images/2016/03/22/nytnow/22xp-boaty/22xp-boaty-articleLarge.jpg?quality=75&auto=webp&disable=upscale"}],"main_user_id":1,"timeline":[{"type":"context","description":"Back at home...","timestamp":1571158845},{"type":"message","uid":"1","content":{"type":"text","data":"Hey! I just got home and I realised that I forgot my phone in the office..."},"timestamp":1571158964},{"type":"message","uid":"2","content":{"type":"text","data":""},"delay":3000,"timestamp":1571159146},{"type":"message","uid":"2","content":{"type":"text","data":"who is texting?"},"delay":3000,"timestamp":1571159147},{"type":"message","uid":"1","content":{"type":"text","data":"for god sake it\'s me"},"delay":3000,"timestamp":1571159355},{"type":"message","uid":"2","content":{"type":"text","data":"??"},"delay":4000,"timestamp":1571159356}]}}')},,function(e,t,a){e.exports={bobble:"Message_bobble__1gGcm",mainUser:"Message_mainUser__29rQH",boobleInner:"Message_boobleInner__yTQxb",username:"Message_username__mYsf7"}},,,,,,,function(e,t,a){e.exports=a(22)},,,,,function(e,t,a){},,function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),i=a(9),r=a.n(i),o=(a(19),a(3)),c=a(6),l=a(4),m=a.n(l),u=a(10),d=a.n(u),p=a(1),_=a.n(p),f=function(e){var t=e.user,a=e.status,n=e.timestamp;return s.a.createElement("div",{className:_()(m.a.header)},s.a.createElement("div",{className:_()(m.a.status)},s.a.createElement("div",{className:_()()},d.a.unix(n).format("HH:mm"))),s.a.createElement("div",{className:_()(m.a.details)},s.a.createElement("div",{className:_()(m.a.avatar),style:{backgroundImage:"url(".concat(t.avatar,")")}}),s.a.createElement("p",{className:_()(m.a.title)},t.name),s.a.createElement("p",{className:_()(m.a.lastSeen)},a)))},h=a(2),v=a.n(h),y=a(11),g=a(7),b=a.n(g),x=function(e){var t=e.text,a=e.align;return""===t?null:s.a.createElement("div",{className:_()(b.a.bobble,Object(y.a)({},b.a.mainUser,"right"===a))},s.a.createElement("div",{className:b.a.boobleInner},s.a.createElement("div",null,t)))},E=function(e){return"context"===e.type?s.a.createElement("div",{className:v.a.caption},s.a.createElement("div",{className:v.a.captionInner},e.description)):function(e){return s.a.createElement(x,{text:e.message,align:e.align})}(e)};var w=function(e){var t=e.entries,a=e.isBuffering,n=e.inputText;return s.a.createElement("div",{className:v.a.main},s.a.createElement("div",{className:v.a.messageWindow},t.map(E),a?s.a.createElement(x,{text:s.a.createElement(s.a.Fragment,null,s.a.createElement("span",{className:v.a.loader}),s.a.createElement("span",{className:v.a.loader}),s.a.createElement("span",{className:v.a.loader}))}):null),s.a.createElement("div",{className:v.a.inputBox},s.a.createElement("p",null,n),s.a.createElement("button",{type:"button"},"send")))},M=a(5),k=a(12),N=a(13),O=function(){function e(t,a){Object(k.a)(this,e),this._eventHandlers=new Map,this._actorId=t;var n=this._flattenTimeline(a),s=Object(o.a)(n,2);this._nextMessage=s[0],this._timeline=s[1],this._playState=0}return Object(N.a)(e,[{key:"play",value:function(){this._playState=1,this.playFrom(this._nextMessage)}},{key:"pause",value:function(){this._playState=0}},{key:"playFrom",value:function(e){if(1===this._playState&&this._nextMessage){var t=this._timeline.get(this._nextMessage);this.dispatch(t)}}},{key:"dispatch",value:function(e){"context"===e.type?this.switchContext(e):parseInt(e.uid)===this._actorId?this.send(e,e.delay):this.receive(e,e.delay)}},{key:"send",value:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;setTimeout((function(){t._typeMessage(e.content.data).then((function(){t.emit("send",[e]),t._setNextMessage(),t.playFrom(t._nextMessage)}))}),a)}},{key:"receive",value:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;setTimeout((function(){t._bufferMessage().then((function(){t.emit("receive",[e]),t._setNextMessage(),t.playFrom(t._nextMessage)}))}),a)}},{key:"switchContext",value:function(e){this.emit("context-changed",[e]),this._setNextMessage(),this.playFrom(this._nextMessage)}},{key:"on",value:function(e,t){return this._eventHandlers.has(e)||this._eventHandlers.set(e,[]),this._eventHandlers.get(e).push(t)}},{key:"off",value:function(e,t){var a=this._eventHandlers.get(e).filter((function(e){return e!==t}));this._eventHandlers.set(e,a)}},{key:"emit",value:function(e,t){this._eventHandlers.get(e).forEach((function(e){e.apply(null,t)}))}},{key:"_typeMessage",value:function(e){var t=this;return new Promise((function(a){var n=0,s=setInterval((function(){n===e.length&&(clearInterval(s),a()),t.emit("text-input",[e[n]]),n++}),90)}))}},{key:"_bufferMessage",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3e3;return new Promise((function(a){e.emit("incoming"),setTimeout(a,t)}))}},{key:"_setNextMessage",value:function(){var e=Array.from(this._timeline.keys()),t=e.indexOf(this._nextMessage)+1;t<e.length?this._nextMessage=e[t]:this._nextMessage=null}},{key:"_flattenTimeline",value:function(e){var t=new Map,a=!0,n=!1,s=void 0;try{for(var i,r=e[Symbol.iterator]();!(a=(i=r.next()).done);a=!0){var o=i.value;t.set(o.timestamp,o)}}catch(c){n=!0,s=c}finally{try{a||null==r.return||r.return()}finally{if(n)throw s}}return[e[0].timestamp,t]}}]),e}();O.prototype.events=["send","receive","context-changed","text-input","incoming"];a(21);var j=function(){var e=Object(c.a)(M.story.users).filter((function(e){return e.id!==M.story.main_user_id})).pop(),t=Object(n.useState)([]),a=Object(o.a)(t,2),i=a[0],r=a[1],l=Object(n.useState)(!1),m=Object(o.a)(l,2),u=m[0],d=m[1],p=Object(n.useState)(""),_=Object(o.a)(p,2),h=_[0],v=_[1],y=Object(n.useState)(Date.now()),g=Object(o.a)(y,2),b=g[0],x=g[1],E=Object(n.useState)("last seen yesterday"),k=Object(o.a)(E,2),N=k[0],j=k[1];return Object(n.useEffect)((function(){var e=new O(M.story.main_user_id,M.story.timeline);e.on("send",(function(e){v((function(e){return""})),x(e.timestamp),r((function(t){return[].concat(Object(c.a)(t),[{message:e.content.data,align:"right"}])}))})),e.on("receive",(function(e){d(!1),x(e.timestamp),r((function(t){return[].concat(Object(c.a)(t),[{message:e.content.data,align:"left"}])}))})),e.on("text-input",(function(e){v((function(t){return t+e}))})),e.on("context-changed",(function(e){x(e.timestamp),r((function(t){return[].concat(Object(c.a)(t),[e])}))})),e.on("incoming",(function(){d(!0),j("online")})),e.play()}),[]),s.a.createElement("div",{className:"App"},s.a.createElement(f,{user:e,timestamp:b,status:N}),s.a.createElement(w,{entries:i,isBuffering:u,inputText:h}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(s.a.createElement(j,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}],[[14,1,2]]]);
//# sourceMappingURL=main.429e8f37.chunk.js.map